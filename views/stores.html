<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saran Toko - Kapan Beli</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ““</text></svg>" type="image/x-icon">
    <link rel="stylesheet" href="/styles/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <nav class="navbar">
        <div class="container nav-container">
            <div class="nav-title">
                <h1>Kapan Beli</h1>
            </div>
            <div class="nav-menu">
                <a href="/" class="nav-link">Beranda</a>
                <a href="/products" class="nav-link">Bahan Saya</a>
                <a href="/suggestions" class="nav-link">Saran Pembelian</a>
                <a href="/stores" class="nav-link active">Saran Toko</a>
            </div>
            <div class="nav-buttons">
                <span class="welcome-text" id="welcomeText" style="margin-right: 1rem; color: white; font-weight: bold;"></span>
                <a href="/auth/logout" class="nav-link">Keluar</a>
                <button class="dark-mode-toggle" title="Toggle Dark Mode">ðŸŒ™</button>
            </div>
        </div>
    </nav>

    <section class="section" style="padding: 2rem 0;">
        <div class="container">
            <h1 class="section-title">Saran Toko Terdekat</h1>
            
            <div class="quick-access-container mb-lg">
                <div class="quick-btn" style="background: #e8f4f8; border-color: #4682b4;" onclick="searchNearbyStores()">
                    <div class="quick-icon">
                        <i class="fas fa-search-location"></i>
                    </div>
                    <div class="quick-label">Cari Toko Terdekat</div>
                </div>
                <div class="quick-btn" style="background: #fff9db; border-color: #FFA500;" onclick="viewFavorites()">
                    <div class="quick-icon">
                        <i class="fas fa-heart"></i>
                    </div>
                    <div class="quick-label">Toko Favorit</div>
                </div>
                <div class="quick-btn" style="background: #e8f5e9; border-color: #4caf50;" onclick="comparePrices()">
                    <div class="quick-icon">
                        <i class="fas fa-tags"></i>
                    </div>
                    <div class="quick-label">Bandingkan Harga</div>
                </div>
            </div>

            <!-- Search Section -->
            <div class="section" style="margin-bottom: 2rem;">
                <div class="stat-card" style="text-align: left; padding: 1.5rem;">
                    <h3 style="color: var(--primary-orange); margin-bottom: 1rem;"><i class="fas fa-map-marker-alt"></i> Lokasi Saat Ini</h3>
                    <div style="display: flex; gap: 1rem; align-items: center; margin-bottom: 1rem;">
                        <input type="text" id="locationInput" placeholder="Masukkan lokasi Anda..." style="flex: 1; padding: 0.7rem; border: 1px solid #333; border-radius: 0;">
                        <button class="submit-btn" style="width: auto; padding: 0.7rem 1.5rem;" onclick="updateLocation()">Perbarui Lokasi</button>
                    </div>
                    <p style="color: #666; font-style: italic;">Lokasi Anda saat ini: Jakarta Selatan, DKI Jakarta</p>
                </div>
            </div>

            <!-- Nearby Stores Section -->
            <div class="section">
                <h2 class="section-title" style="font-size: 1.8rem; margin-bottom: 1.5rem;">Toko Terdekat</h2>
                <div class="activity-container">
                    <div class="activity-list">
                        <div class="activity-item" style="margin-bottom: 1.5rem; padding: 1.5rem;">
                            <div class="activity-icon" style="font-size: 2rem;">
                                <i class="fas fa-store"></i>
                            </div>
                            <div class="activity-content" style="text-align: left;">
                                <div><h3 style="color: var(--primary-orange); margin: 0 0 0.5rem 0;">Pasar Santa</h3></div>
                                <div style="display: flex; gap: 1rem; margin-bottom: 0.5rem;">
                                    <span style="display: flex; align-items: center; gap: 0.3rem;"><i class="fas fa-star" style="color: gold;"></i> 4.5</span>
                                    <span><i class="fas fa-map-marker-alt" style="color: #FF6347;"></i> 0.8 km</span>
                                    <span><i class="fas fa-clock" style="color: #4CAF50;"></i> Buka</span>
                                </div>
                                <p>Salah satu pasar tradisional terbesar di Jakarta Selatan dengan berbagai macam sayur dan bumbu segar.</p>
                                <div style="margin-top: 1rem;">
                                    <button class="nav-link" style="padding: 0.4rem 1rem; margin-right: 0.5rem;">Lihat Rute</button>
                                    <button class="nav-link" style="padding: 0.4rem 1rem; background: #ff6b6b; border-color: #ff6b6b;">Tambah Favorit</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="activity-item" style="margin-bottom: 1.5rem; padding: 1.5rem;">
                            <div class="activity-icon" style="font-size: 2rem;">
                                <i class="fas fa-shopping-cart"></i>
                            </div>
                            <div class="activity-content" style="text-align: left;">
                                <div><h3 style="color: var(--primary-orange); margin: 0 0 0.5rem 0;">Hypermart TB Simatupang</h3></div>
                                <div style="display: flex; gap: 1rem; margin-bottom: 0.5rem;">
                                    <span style="display: flex; align-items: center; gap: 0.3rem;"><i class="fas fa-star" style="color: gold;"></i> 4.3</span>
                                    <span><i class="fas fa-map-marker-alt" style="color: #FF6347;"></i> 1.2 km</span>
                                    <span><i class="fas fa-clock" style="color: #4CAF50;"></i> Buka</span>
                                </div>
                                <p>Supermarket besar dengan berbagai jenis bahan masak dan produk segar.</p>
                                <div style="margin-top: 1rem;">
                                    <button class="nav-link" style="padding: 0.4rem 1rem; margin-right: 0.5rem;">Lihat Rute</button>
                                    <button class="nav-link" style="padding: 0.4rem 1rem; background: #ff6b6b; border-color: #ff6b6b;">Tambah Favorit</button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="activity-item" style="margin-bottom: 1.5rem; padding: 1.5rem;">
                            <div class="activity-icon" style="font-size: 2rem;">
                                <i class="fas fa-seedling"></i>
                            </div>
                            <div class="activity-content" style="text-align: left;">
                                <div><h3 style="color: var(--primary-orange); margin: 0 0 0.5rem 0;">Toko Sayur Segar</h3></div>
                                <div style="display: flex; gap: 1rem; margin-bottom: 0.5rem;">
                                    <span style="display: flex; align-items: center; gap: 0.3rem;"><i class="fas fa-star" style="color: gold;"></i> 4.7</span>
                                    <span><i class="fas fa-map-marker-alt" style="color: #FF6347;"></i> 1.5 km</span>
                                    <span><i class="fas fa-clock" style="color: #4CAF50;"></i> Buka</span>
                                </div>
                                <p>Toko spesialis sayur dan buah organik segar langsung dari petani lokal.</p>
                                <div style="margin-top: 1rem;">
                                    <button class="nav-link" style="padding: 0.4rem 1rem; margin-right: 0.5rem;">Lihat Rute</button>
                                    <button class="nav-link" style="padding: 0.4rem 1rem; background: #ff6b6b; border-color: #ff6b6b;">Tambah Favorit</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Price Comparison Section -->
            <div class="section">
                <h2 class="section-title" style="font-size: 1.8rem; margin-bottom: 1.5rem;">Perbandingan Harga</h2>
                <div class="stat-card" style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse; min-width: 600px;">
                        <thead>
                            <tr style="background: var(--primary-orange); color: white;">
                                <th style="padding: 1rem; text-align: left;">Produk</th>
                                <th style="padding: 1rem; text-align: left;">Pasar Santa</th>
                                <th style="padding: 1rem; text-align: left;">Hypermart</th>
                                <th style="padding: 1rem; text-align: left;">Toko Sayur Segar</th>
                                <th style="padding: 1rem; text-align: left;">Rekomendasi</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="border-bottom: 1px solid #ddd;">
                                <td style="padding: 1rem;"><strong>Bawang Merah</strong></td>
                                <td style="padding: 1rem;">Rp 15.000/kg</td>
                                <td style="padding: 1rem;">Rp 18.000/kg</td>
                                <td style="padding: 1rem;">Rp 12.000/kg</td>
                                <td style="padding: 1rem;"><span style="background: #4CAF50; color: white; padding: 0.3rem 0.8rem; border-radius: 20px;">Toko Sayur Segar</span></td>
                            </tr>
                            <tr style="border-bottom: 1px solid #ddd;">
                                <td style="padding: 1rem;"><strong>Cabai Rawit</strong></td>
                                <td style="padding: 1rem;">Rp 25.000/kg</td>
                                <td style="padding: 1rem;">Rp 30.000/kg</td>
                                <td style="padding: 1rem;">Rp 22.000/kg</td>
                                <td style="padding: 1rem;"><span style="background: #4CAF50; color: white; padding: 0.3rem 0.8rem; border-radius: 20px;">Toko Sayur Segar</span></td>
                            </tr>
                            <tr>
                                <td style="padding: 1rem;"><strong>Tomat</strong></td>
                                <td style="padding: 1rem;">Rp 12.000/kg</td>
                                <td style="padding: 1rem;">Rp 15.000/kg</td>
                                <td style="padding: 1rem;">Rp 10.000/kg</td>
                                <td style="padding: 1rem;"><span style="background: #4CAF50; color: white; padding: 0.3rem 0.8rem; border-radius: 20px;">Toko Sayur Segar</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2026 Kapan Beli - Catatan Stok Bahan Masak. Semua hak dilindungi.</p>
        </div>
    </footer>

    <script>
        // Dark mode toggle functionality
        const darkModeToggle = document.querySelector('.dark-mode-toggle');
        const body = document.body;

        // Check for saved theme preference or respect OS setting
        if (localStorage.getItem('theme') === 'dark' ||
            (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            body.classList.add('dark-mode-active');
        } else {
            body.classList.remove('dark-mode-active');
        }

        darkModeToggle?.addEventListener('click', function() {
            body.classList.toggle('dark-mode-active');

            // Save the current theme to localStorage
            if (body.classList.contains('dark-mode-active')) {
                localStorage.setItem('theme', 'dark');
            } else {
                localStorage.setItem('theme', 'light');
            }
        });

        // Function to search nearby stores
        function searchNearbyStores() {
            alert('Mencari toko terdekat berdasarkan lokasi Anda...');
        }

        // Function to view favorites
        function viewFavorites() {
            alert('Menampilkan toko favorit Anda...');
        }

        // Function to compare prices
        function comparePrices() {
            alert('Menampilkan perbandingan harga produk di berbagai toko...');
        }

        // Function to update location
        function updateLocation() {
            const locationInput = document.getElementById('locationInput');
            if(locationInput.value.trim() !== '') {
                alert('Lokasi diperbarui: ' + locationInput.value);
            } else {
                alert('Silakan masukkan lokasi Anda terlebih dahulu.');
            }
        }

        // Check auth status
        async function checkAuthStatus() {
            try {
                const response = await fetch('/auth/status', {
                    method: 'GET',
                    credentials: 'same-origin'
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.authenticated) {
                        document.getElementById('welcomeText').textContent = `Halo, ${data.user.name}!`;
                        document.getElementById('welcomeText').style.display = 'inline';
                    } else {
                        window.location.href = '/auth';
                    }
                }
            } catch (error) {
                console.error('Error checking auth status:', error);
                window.location.href = '/auth';
            }
        }

        // Check auth status when page loads
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
        });
    </script>
</body>
</html>