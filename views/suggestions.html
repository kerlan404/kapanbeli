<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Saran Pembelian - Kapan Beli</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ““</text></svg>" type="image/x-icon">
    <link rel="stylesheet" href="/styles/main.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <nav class="navbar">
        <div class="container nav-container">
            <div class="nav-title">
                <h1>Kapan Beli</h1>
            </div>
            <div class="nav-menu">
                <a href="/" class="nav-link">Beranda</a>
                <a href="/products" class="nav-link">Bahan Saya</a>
                <a href="/suggestions" class="nav-link active">Saran Pembelian</a>
                <a href="/stores" class="nav-link">Saran Toko</a>
            </div>
            <div class="nav-buttons">
                <span class="welcome-text" id="welcomeText" style="margin-right: 1rem; color: white; font-weight: bold;"></span>
                <a href="/auth/logout" class="nav-link">Keluar</a>
                <button class="dark-mode-toggle" title="Toggle Dark Mode">ðŸŒ™</button>
            </div>
        </div>
    </nav>

    <section class="section" style="padding: 2rem 0;">
        <div class="container">
            <h1 class="section-title">Saran Pembelian</h1>
            
            <div class="quick-access-container mb-lg">
                <div class="quick-btn" style="background: #e8f4f8; border-color: #4682b4;" onclick="generateShoppingList()">
                    <div class="quick-icon">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <div class="quick-label">Buat Daftar Belanja</div>
                </div>
                <div class="quick-btn" style="background: #fff9db; border-color: #FFA500;" onclick="checkLowStock()">
                    <div class="quick-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="quick-label">Stok Rendah</div>
                </div>
                <div class="quick-btn" style="background: #e8f5e9; border-color: #4caf50;" onclick="suggestRecipes()">
                    <div class="quick-icon">
                        <i class="fas fa-utensils"></i>
                    </div>
                    <div class="quick-label">Saran Resep</div>
                </div>
            </div>

            <!-- Shopping List Section -->
            <div class="section">
                <h2 class="section-title" style="font-size: 1.8rem; margin-bottom: 1.5rem;">Daftar Belanja Minggu Ini</h2>
                <div class="activity-container">
                    <div class="stat-card" style="margin-bottom: 1.5rem; text-align: left;">
                        <h3 style="color: var(--primary-orange); margin-bottom: 1rem;"><i class="fas fa-shopping-cart"></i> Barang yang Perlu Dibeli</h3>
                        <ul style="list-style: none; padding: 0;">
                            <li style="padding: 0.5rem 0; border-bottom: 1px solid #eee;">
                                <input type="checkbox" id="item1" style="margin-right: 10px;">
                                <label for="item1">Bawang Merah - 5 bh</label>
                                <span style="float: right; color: #666;">Prioritas Tinggi</span>
                            </li>
                            <li style="padding: 0.5rem 0; border-bottom: 1px solid #eee;">
                                <input type="checkbox" id="item2" style="margin-right: 10px;">
                                <label for="item2">Cabai Rawit - 1 ons</label>
                                <span style="float: right; color: #666;">Prioritas Sedang</span>
                            </li>
                            <li style="padding: 0.5rem 0; border-bottom: 1px solid #eee;">
                                <input type="checkbox" id="item3" style="margin-right: 10px;">
                                <label for="item3">Tomat - 3 bh</label>
                                <span style="float: right; color: #666;">Prioritas Rendah</span>
                            </li>
                            <li style="padding: 0.5rem 0; border-bottom: 1px solid #eee;">
                                <input type="checkbox" id="item4" style="margin-right: 10px;">
                                <label for="item4">Bawang Putih - 3 bh</label>
                                <span style="float: right; color: #666;">Prioritas Sedang</span>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Low Stock Items -->
            <div class="section">
                <h2 class="section-title" style="font-size: 1.8rem; margin-bottom: 1.5rem;">Item dengan Stok Rendah</h2>
                <div class="activity-container">
                    <div class="activity-list">
                        <div class="activity-item" style="margin-bottom: 1rem;">
                            <div class="activity-icon">
                                <i class="fas fa-exclamation-triangle" style="color: #FF6347;"></i>
                            </div>
                            <div class="activity-content">
                                <div><strong>Bawang Merah</strong> - Tersisa 1 bh</div>
                                <div class="activity-time">Perlu dibeli segera</div>
                            </div>
                        </div>
                        <div class="activity-item" style="margin-bottom: 1rem;">
                            <div class="activity-icon">
                                <i class="fas fa-exclamation-triangle" style="color: #FFA500;"></i>
                            </div>
                            <div class="activity-content">
                                <div><strong>Cabai Rawit</strong> - Tersisa 2 bh</div>
                                <div class="activity-time">Akan habis minggu depan</div>
                            </div>
                        </div>
                        <div class="activity-item">
                            <div class="activity-icon">
                                <i class="fas fa-exclamation-triangle" style="color: #FFA500;"></i>
                            </div>
                            <div class="activity-content">
                                <div><strong>Tomat</strong> - Tersisa 1 bh</div>
                                <div class="activity-time">Akan habis akhir pekan ini</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Recipe Suggestions -->
            <div class="section">
                <h2 class="section-title" style="font-size: 1.8rem; margin-bottom: 1.5rem;">Saran Resep Minggu Ini</h2>
                <div class="testimonial-container">
                    <div class="testimonial-card" style="text-align: left;">
                        <h3 style="color: var(--primary-orange); margin-bottom: 0.5rem;"><i class="fas fa-utensils"></i> Tumis Buncis Telur</h3>
                        <p>Resep ini menggunakan bahan-bahan yang umum dan cocok untuk menu sehari-hari.</p>
                        <div style="margin-top: 1rem; display: flex; gap: 0.5rem;">
                            <span style="background: #e8f4f8; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.9rem;">Vegetarian</span>
                            <span style="background: #fff9db; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.9rem;">Mudah</span>
                        </div>
                    </div>
                    <div class="testimonial-card" style="text-align: left;">
                        <h3 style="color: var(--primary-orange); margin-bottom: 0.5rem;"><i class="fas fa-utensils"></i> Sambal Terasi</h3>
                        <p>Sambal pedas yang cocok untuk pelengkap berbagai hidangan.</p>
                        <div style="margin-top: 1rem; display: flex; gap: 0.5rem;">
                            <span style="background: #ffccbc; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.9rem;">Pedas</span>
                            <span style="background: #fff9db; padding: 0.3rem 0.8rem; border-radius: 20px; font-size: 0.9rem;">Cepat</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2026 Kapan Beli - Catatan Stok Bahan Masak. Semua hak dilindungi.</p>
        </div>
    </footer>

    <script>
        // Dark mode toggle functionality
        const darkModeToggle = document.querySelector('.dark-mode-toggle');
        const body = document.body;

        // Check for saved theme preference or respect OS setting
        if (localStorage.getItem('theme') === 'dark' ||
            (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            body.classList.add('dark-mode-active');
        } else {
            body.classList.remove('dark-mode-active');
        }

        darkModeToggle?.addEventListener('click', function() {
            body.classList.toggle('dark-mode-active');

            // Save the current theme to localStorage
            if (body.classList.contains('dark-mode-active')) {
                localStorage.setItem('theme', 'dark');
            } else {
                localStorage.setItem('theme', 'light');
            }
        });

        // Function to generate shopping list
        function generateShoppingList() {
            alert('Daftar belanja telah diperbarui berdasarkan stok saat ini!');
        }

        // Function to check low stock items
        function checkLowStock() {
            alert('Memeriksa item dengan stok rendah...');
        }

        // Function to suggest recipes
        function suggestRecipes() {
            alert('Menampilkan saran resep berdasarkan bahan yang tersedia...');
        }

        // Check auth status
        async function checkAuthStatus() {
            try {
                const response = await fetch('/auth/status', {
                    method: 'GET',
                    credentials: 'same-origin'
                });
                
                if (response.ok) {
                    const data = await response.json();
                    if (data.authenticated) {
                        document.getElementById('welcomeText').textContent = `Halo, ${data.user.name}!`;
                        document.getElementById('welcomeText').style.display = 'inline';
                    } else {
                        window.location.href = '/auth';
                    }
                }
            } catch (error) {
                console.error('Error checking auth status:', error);
                window.location.href = '/auth';
            }
        }

        // Check auth status when page loads
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
        });
    </script>
</body>
</html>